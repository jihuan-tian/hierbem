# List of implemented H-matrix arithemtic operations

| Operator                                                                                                                                                                                                                                                                                                  | Functions to be performed                                                                                                                             | C++ functions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| -------                                                                                                                                                                                                                                                                                                   | -------------------------                                                                                                                             | -------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| \f$\mathcal{T}_{r \leftarrow s}^{\mathcal{R}}\f$                                                                                                                                                                                                                                                          | Truncation of a rank-k matrix                                                                                                                         | RkMatrix<Number>::truncate_to_rank(size_type new_rank)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| \f$\mathcal{T}_{r \leftarrow s}^{\mathcal{H}}\f$                                                                                                                                                                                                                                                          | Truncation of rank-k matrix blocks in an \f$\mathcal{H}\f$-matrix                                                                                     | HMatrix<spacedim, Number>::truncate_to_rank(size_type new_rank)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| \f$\mathcal{T}_r^{\mathcal{R} \leftarrow \mathcal{F}}\f$                                                                                                                                                                                                                                                  | Convert a full matrix to rank-k matrix                                                                                                                | <ul><li>RkMatrix<Number>::RkMatrix(const size_type fixed_rank_k, LAPACKFullMatrixExt<Number> &M) <li>RkMatrix<Number>::RkMatrix(LAPACKFullMatrixExt<Number> &M)</ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| \f$M\vert_b\f$ where \f$M \in \mathcal{F}\f$                                                                                                                                                                                                                                                                   | Restrict a full matrix \f$M\f$ to the block cluster \f$b = \tau \times \sigma\f$ as a full matrix                                                     | <ul><li>LAPACKFullMatrixExt( const std::vector<types::global_dof_index> &tau_index_set, const std::vector<types::global_dof_index> &sigma_index_set, const LAPACKFullMatrixExt<Number> & M)<li>LAPACKFullMatrixExt( const std::vector<types::global_dof_index> &tau_index_set, const std::vector<types::global_dof_index> &sigma_index_set, const LAPACKFullMatrixExt<Number> & M, const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> &col_index_global_to_local_map_for_M)</ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| \f$\mathcal{T}_r^{\mathcal{R} \leftarrow \mathcal{F}}(M \vert_b)\f$ where \f$M \in \mathcal{F}\f$                                                                                                                                                                                                         | Restrict a full matrix \f$M\f$ to the block cluster \f$b = \tau \times \sigma\f$ and convert it to a rank-k matrix                                    | <ul><li>RkMatrix<Number>::RkMatrix(const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const size_type fixed_rank_k, const LAPACKFullMatrixExt<Number> & M) <li>RkMatrix<Number>::RkMatrix(const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const LAPACKFullMatrixExt<Number> & M) <li>RkMatrix<Number>::RkMatrix(const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const size_type fixed_rank_k, const LAPACKFullMatrixExt<Number> & M, const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> &col_index_global_to_local_map_for_M) <li>RkMatrix<Number>::RkMatrix(const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const LAPACKFullMatrixExt<Number> & M, const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> &col_index_global_to_local_map_for_M)</ul> |
| \f$\mathcal{T}_{r \leftarrow s}^{\mathcal{R}}(M\vert_b)\f$ where \f$M \in \mathcal{R}\f$                                                                                                                                                                                                                  | Restrict a rank-k matrix \f$M\f$ to the block cluster \f$b = \tau \times \sigma\f$ as a rank-k matrix                                                 | <ul><li>RkMatrix<Number>::RkMatrix(const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const size_type fixed_rank_k, const RkMatrix<Number> & M)<li>RkMatrix<Number>::RkMatrix(const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const RkMatrix<Number> & M)<li>RkMatrix<Number>::RkMatrix(const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const size_type fixed_rank_k, const RkMatrix<Number> & M, const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> &col_index_global_to_local_map_for_M)<li>RkMatrix<Number>::RkMatrix(const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const RkMatrix<Number> & M, const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> &col_index_global_to_local_map_for_M)</ul>                                                |
| \f$\mathcal{T}^{\mathcal{F} \leftarrow \mathcal{R}}(M\vert_b)\f$ where \f$M \in \mathcal{R}\f$                                                                                                                                                                                                            | Restrict a rank-k matrix \f$M\f$ to the block cluster \f$b = \tau \times \sigma\f$ as a full matrix                                                   | <ul><li>RkMatrix<Number>::restrictToFullMatrix( const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, LAPACKFullMatrixExt<Number> & matrix) const<li>RkMatrix<Number>::restrictToFullMatrix( const std::vector<types::global_dof_index> &tau, const std::vector<types::global_dof_index> &sigma, const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_rk, const std::map<types::global_dof_index, size_t> & col_index_global_to_local_map_for_rk, LAPACKFullMatrixExt<Number> &matrix) const</ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| \f$M = \begin{pmatrix} M_1 & M_2 \\ M_3 & M_4 \end{pmatrix}\f$                                                                                                                                                                                                                                            | Agglomeration of four full submatrices in \p CrossSplitMode into a larger full matrix                                                                 | <ul><li>LAPACKFullMatrixExt<Number>::LAPACKFullMatrixExt(const LAPACKFullMatrixExt &M11, const LAPACKFullMatrixExt &M12, const LAPACKFullMatrixExt &M21, const LAPACKFullMatrixExt &M22)<li>LAPACKFullMatrixExt<Number>::LAPACKFullMatrixExt( const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> & col_index_global_to_local_map_for_M, const LAPACKFullMatrixExt &M11, const std::vector<types::global_dof_index> &M11_tau_index_set, const std::vector<types::global_dof_index> &M11_sigma_index_set, const LAPACKFullMatrixExt & M12, const std::vector<types::global_dof_index> &M12_tau_index_set, const std::vector<types::global_dof_index> &M12_sigma_index_set, const LAPACKFullMatrixExt & M21, const std::vector<types::global_dof_index> &M21_tau_index_set, const std::vector<types::global_dof_index> &M21_sigma_index_set, const LAPACKFullMatrixExt & M22, const std::vector<types::global_dof_index> &M22_tau_index_set, const std::vector<types::global_dof_index> &M22_sigma_index_set)</ul>                                   |
| \f$M = \begin{pmatrix} M_1 & M_2 \end{pmatrix}\f$ or \f$M = \begin{pmatrix} M_1 \\ M_2 \end{pmatrix}\f$                                                                                                                                                                                                   | Agglomeration of two full submatrices in either \p HorizontalSplitMode or \p VerticalSplitMode into a larger full matrix                              | <ul><li>LAPACKFullMatrixExt<Number>::LAPACKFullMatrixExt(const LAPACKFullMatrixExt &M1, const LAPACKFullMatrixExt &M2, bool is_horizontal_split)<li>LAPACKFullMatrixExt<Number>::LAPACKFullMatrixExt( const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> & col_index_global_to_local_map_for_M, const LAPACKFullMatrixExt &M1, const std::vector<types::global_dof_index> &M1_tau_index_set, const std::vector<types::global_dof_index> &M1_sigma_index_set, const LAPACKFullMatrixExt & M2, const std::vector<types::global_dof_index> &M2_tau_index_set, const std::vector<types::global_dof_index> &M2_sigma_index_set, bool is_horizontal_split)</ul>                                                                                                                                                                                                                                                                                                                                                                                         |
| \f[\begin{aligned}\mathcal{T}_{r, {\rm pairw}}^{\mathcal{R}}(M) &= \mathcal{T}_{r, {\rm pairw}}^{\mathcal{R}}\left(\begin{pmatrix} M_1 & M_2 \\ M_3 & M_4 \end{pmatrix}\right) \\ &= M_1\vert^b + M_2\vert^b + M_3\vert^b + M_4\vert^b\end{aligned}\f]                                                    | Agglomeration of four rank-k submatrices into a larger rank-k matrix using pairwise formatted addition                                                | <ul><li>RkMatrix<Number>::RkMatrix(const size_type fixed_rank_k, const RkMatrix<Number> &M11, const RkMatrix<Number> &M12, const RkMatrix<Number> &M21, const RkMatrix<Number> &M22)<li>RkMatrix<Number>::RkMatrix(const size_type fixed_rank_k, const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> & col_index_global_to_local_map_for_M, const RkMatrix<Number> &M11, const std::vector<types::global_dof_index> &M11_tau_index_set, const std::vector<types::global_dof_index> &M11_sigma_index_set, const RkMatrix<Number> & M12, const std::vector<types::global_dof_index> &M12_tau_index_set, const std::vector<types::global_dof_index> &M12_sigma_index_set, const RkMatrix<Number> & M21, const std::vector<types::global_dof_index> &M21_tau_index_set, const std::vector<types::global_dof_index> &M21_sigma_index_set, const RkMatrix<Number> & M22, const std::vector<types::global_dof_index> &M22_tau_index_set, const std::vector<types::global_dof_index> &M22_sigma_index_set)</ul>                                            |
| \f$\mathcal{T}_r^{\mathcal{R}}(M) = \mathcal{T}_r^{\mathcal{R}}\left(\begin{pmatrix} M_1 & M_2 \end{pmatrix}\right) = M_1 \vert^b + M_2 \vert^b\f$ or \f$\mathcal{T}_r^{\mathcal{R}}(M) = \mathcal{T}_r^{\mathcal{R}}\left(\begin{pmatrix} M_1 \\ M_2 \end{pmatrix}\right) = M_1 \vert^b + M_2 \vert^b\f$ | Agglomeration of two rank-k submatrices in either \p HorizontalSplitMode or \p VerticalSplitMode into a larger rank-k matrix using formatted addition | <ul><li>RkMatrix<Number>::RkMatrix(const size_type fixed_rank_k, const RkMatrix<Number> &M1, const RkMatrix<Number> &M2, bool is_horizontal_split)<li>RkMatrix<Number>::RkMatrix(const size_type fixed_rank_k, const std::map<types::global_dof_index, size_t> &row_index_global_to_local_map_for_M, const std::map<types::global_dof_index, size_t> & col_index_global_to_local_map_for_M, const RkMatrix<Number> &M1, const std::vector<types::global_dof_index> &M1_tau_index_set, const std::vector<types::global_dof_index> &M1_sigma_index_set, const RkMatrix<Number> & M2, const std::vector<types::global_dof_index> &M2_tau_index_set, const std::vector<types::global_dof_index> &M2_sigma_index_set, bool is_horizontal_split)</ul>                                                                                                                                                                                                                                                                                                                                                                                      |
| \f$\mathcal{T}^{\mathcal{F} \leftarrow \mathcal{R}}\f$                                                                                                                                                                                                                                                    | Convert a rank-k matrix to a full matrix (for verification purpose only)                                                                              | RkMatrix<Number>::convertToFullMatrix(LAPACKFullMatrixExt<Number> &matrix) const                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| \f$\mathcal{T}^{\mathcal{F} \leftarrow \mathcal{H}}\f$                                                                                                                                                                                                                                                    | Convert an \f$\mathcal{H}\f$-matrix to a full matrix (for verification purpose only)                                                                  | HMatrix<spacedim, Number>::convertToFullMatrix(MatrixType &M) const                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| \f$\mathcal{T}_r^{\mathcal{R} \leftarrow \mathcal{H}} \; (Convert\_H)\f$                                                                                                                                                                                                                                  | Convert an \f$\mathcal{H}\f$-matrix to a rank-k matrix                                                                                                | convertHMatBlockToRkMatrix(HMatrix<spacedim, Number> * hmat_block, const unsigned int fixed_rank_k, const HMatrix<spacedim, Number> *hmat_root_block, size_t * calling_counter, const std::string &output_file_base_name)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| \f$\mathcal{T}_{P' \leftarrow P}^{\mathcal{H} \leftarrow \mathcal{H}}\f$ with \f$T(I \times J, P') \subset T(I \times J, P)\f$                                                                                                                                                                            | Coarsen an \f$\mathcal{H}\f$-matrix to a subtree \f$T(I \times J, P')\f$ or the partition \f$P'\f$                                                    | <ul><li>HMatrix<spacedim, Number>::coarsen_to_subtree( const BlockClusterTree<spacedim, Number> &subtree, const unsigned int fixed_rank_k)<li>HMatrix<spacedim, Number>::coarsen_to_partition( const std::vector< typename BlockClusterTree<spacedim, Number>::node_pointer_type> &partition, const unsigned int fixed_rank_k)</ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| \f$\mathcal{T}_{P' \leftarrow P}^{\mathcal{H} \leftarrow \mathcal{H}}\f$ with \f$T(I \times J, P') \supset T(I \times J, P)\f$                                                                                                                                                                            | Refine an \f$\mathcal{H}\f$-matrix to an extended block cluster tree with the finer partition \f$P'\f$                                                | HMatrix<spacedim, Number>::refine_to_supertree()                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| \f$\mathcal{T}_{P' \leftarrow P}^{\mathcal{H} \leftarrow \mathcal{H}}\f$ with \f$T(I \times J, P') \not\subset T(I \times J, P)\f$ and \f$T(I \times J, P') \not\supset T(I \times J, P)\f$                                                                                                               | Convert an \f$\mathcal{H}\f$-matrix to another \f$\mathcal{H}\f$-matrix with a different block cluster tree                                           | HMatrix<spacedim, Number>::convert_between_different_block_cluster_trees( BlockClusterTree<spacedim, Number> &bct1, BlockClusterTree<spacedim, Number> &bct2, const unsigned int fixed_rank_k2)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| \f$y\vert_{\tau} = y\vert_{\tau} + M\vert_b \cdot x\vert_{\sigma}\f$ | Multiplication of an \f$\mathcal{H}\f$-matrix and a block vector | HMatrix<spacedim, Number>::vmult(Vector<Number> & y, const Vector<Number> &x) const |
| \f$y\vert_{\sigma} = y\vert_{\sigma} + M^T\vert_b \cdot x\vert_{\tau} \f$ | Multiplication of the transpose of an \f$\mathcal{H}\f$-matrix and a block vector | HMatrix<spacedim, Number>::Tvmult(Vector<Number> & y, const Vector<Number> &x) const |
| \f$ M_1 \oplus_r M_2 \f$ | Formatted addition of two \f$\mathcal{H}\f$-matrices | HMatrix<spacedim, Number>::add(HMatrix<spacedim, Number> & C, const HMatrix<spacedim, Number> &B, const size_type fixed_rank_k) const |
