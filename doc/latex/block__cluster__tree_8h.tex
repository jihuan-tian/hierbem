\hypertarget{block__cluster__tree_8h}{}\section{/home/jihuan/\+Projects/deal.ii/program/dealii-\/9.1.1/examples/laplace-\/bem/include/block\+\_\+cluster\+\_\+tree.h File Reference}
\label{block__cluster__tree_8h}\index{/home/jihuan/\+Projects/deal.\+ii/program/dealii-\/9.\+1.\+1/examples/laplace-\/bem/include/block\+\_\+cluster\+\_\+tree.\+h@{/home/jihuan/\+Projects/deal.\+ii/program/dealii-\/9.\+1.\+1/examples/laplace-\/bem/include/block\+\_\+cluster\+\_\+tree.\+h}}


Implementation of the class \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}.  


{\ttfamily \#include \char`\"{}block\+\_\+cluster.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}cluster\+\_\+tree.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}debug\+\_\+tools.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}lapack\+\_\+full\+\_\+matrix\+\_\+ext.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tree.\+h\char`\"{}}\newline
Include dependency graph for block\+\_\+cluster\+\_\+tree.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{block__cluster__tree_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{block__cluster__tree_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree$<$ spacedim, Number $>$}
\begin{DoxyCompactList}\small\item\em Class for block cluster tree. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\textbf{ }\par
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{block__cluster__tree_8h_a86a6c2e186f20eb650591ddca69940b7}\label{block__cluster__tree_8h_a86a6c2e186f20eb650591ddca69940b7}} 
{\footnotesize template$<$int spacedim, typename Number $>$ }\\std\+::ostream \& {\bfseries operator$<$$<$} (std\+::ostream \&out, const \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$ \&block\+\_\+cluster\+\_\+tree)
\item 
{\footnotesize template$<$int spacedim, typename Number $>$ }\\void \hyperlink{block__cluster__tree_8h_a16ad2c7c8e746258ce244315d6181c72}{split\+\_\+block\+\_\+cluster\+\_\+node} (\hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$bc\+\_\+node, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$ \&bc\+\_\+tree, const \hyperlink{tree_8h_a922ca07db9633957939f697a65aff11d}{Tree\+Node\+Split\+Mode} split\+\_\+mode, const bool if\+\_\+add\+\_\+child\+\_\+nodes\+\_\+to\+\_\+leaf\+\_\+set=true)
\item 
{\footnotesize template$<$int spacedim, typename Number  = double$>$ }\\bool \hyperlink{block__cluster__tree_8h_a3b2f90afbf0d192ac657f6fab5a87294}{prune\+\_\+to\+\_\+partition\+\_\+recursion} (\hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$ \&bct, const std\+::vector$<$ \hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$$>$ \&partition, \hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$bc\+\_\+node)
\item 
{\footnotesize template$<$int spacedim, typename Number $>$ }\\\hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$ \hyperlink{block__cluster__tree_8h_a6ae11dfea883425641ebd2683cd482b6}{find\+\_\+bc\+\_\+node\+\_\+in\+\_\+partition\+\_\+intersect\+\_\+current\+\_\+bc\+\_\+node} (\hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$current\+\_\+bc\+\_\+node, const std\+::vector$<$ \hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$$>$ \&partition)
\item 
\mbox{\Hypertarget{block__cluster__tree_8h_a90e9fdffdd0ca85bd525dd9f29de3c93}\label{block__cluster__tree_8h_a90e9fdffdd0ca85bd525dd9f29de3c93}} 
{\footnotesize template$<$int spacedim, typename Number $>$ }\\\hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$ {\bfseries find\+\_\+bc\+\_\+node\+\_\+in\+\_\+partition\+\_\+proper\+\_\+subset\+\_\+of\+\_\+current\+\_\+bc\+\_\+node} (\hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$current\+\_\+bc\+\_\+node, const std\+::vector$<$ \hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$$>$ \&partition)
\end{DoxyCompactItemize}



\subsection{Detailed Description}
Implementation of the class \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}. 

\begin{DoxyDate}{Date}
2021-\/04-\/20 
\end{DoxyDate}
\begin{DoxyAuthor}{Author}
Jihuan Tian 
\end{DoxyAuthor}


\subsection{Function Documentation}
\mbox{\Hypertarget{block__cluster__tree_8h_a6ae11dfea883425641ebd2683cd482b6}\label{block__cluster__tree_8h_a6ae11dfea883425641ebd2683cd482b6}} 
\index{block\+\_\+cluster\+\_\+tree.\+h@{block\+\_\+cluster\+\_\+tree.\+h}!find\+\_\+bc\+\_\+node\+\_\+in\+\_\+partition\+\_\+intersect\+\_\+current\+\_\+bc\+\_\+node@{find\+\_\+bc\+\_\+node\+\_\+in\+\_\+partition\+\_\+intersect\+\_\+current\+\_\+bc\+\_\+node}}
\index{find\+\_\+bc\+\_\+node\+\_\+in\+\_\+partition\+\_\+intersect\+\_\+current\+\_\+bc\+\_\+node@{find\+\_\+bc\+\_\+node\+\_\+in\+\_\+partition\+\_\+intersect\+\_\+current\+\_\+bc\+\_\+node}!block\+\_\+cluster\+\_\+tree.\+h@{block\+\_\+cluster\+\_\+tree.\+h}}
\subsubsection{\texorpdfstring{find\+\_\+bc\+\_\+node\+\_\+in\+\_\+partition\+\_\+intersect\+\_\+current\+\_\+bc\+\_\+node()}{find\_bc\_node\_in\_partition\_intersect\_current\_bc\_node()}}
{\footnotesize\ttfamily template$<$int spacedim, typename Number $>$ \\
\hyperlink{classTreeNode}{Tree\+Node}$<$\hyperlink{classBlockCluster}{Block\+Cluster}$<$spacedim, Number$>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$spacedim, Number$>$\+::child\+\_\+num$>$$\ast$ find\+\_\+bc\+\_\+node\+\_\+in\+\_\+partition\+\_\+intersect\+\_\+current\+\_\+bc\+\_\+node (\begin{DoxyParamCaption}\item[{\hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$}]{current\+\_\+bc\+\_\+node,  }\item[{const std\+::vector$<$ \hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$$>$ \&}]{partition }\end{DoxyParamCaption})}

Find a block cluster node in the given partition which has nonempty intersection with the current block cluster node. \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


References Block\+Cluster\+Tree$<$ spacedim, Number $>$\+::partition().

\mbox{\Hypertarget{block__cluster__tree_8h_a3b2f90afbf0d192ac657f6fab5a87294}\label{block__cluster__tree_8h_a3b2f90afbf0d192ac657f6fab5a87294}} 
\index{block\+\_\+cluster\+\_\+tree.\+h@{block\+\_\+cluster\+\_\+tree.\+h}!prune\+\_\+to\+\_\+partition\+\_\+recursion@{prune\+\_\+to\+\_\+partition\+\_\+recursion}}
\index{prune\+\_\+to\+\_\+partition\+\_\+recursion@{prune\+\_\+to\+\_\+partition\+\_\+recursion}!block\+\_\+cluster\+\_\+tree.\+h@{block\+\_\+cluster\+\_\+tree.\+h}}
\subsubsection{\texorpdfstring{prune\+\_\+to\+\_\+partition\+\_\+recursion()}{prune\_to\_partition\_recursion()}}
{\footnotesize\ttfamily template$<$int spacedim, typename Number  = double$>$ \\
bool prune\+\_\+to\+\_\+partition\+\_\+recursion (\begin{DoxyParamCaption}\item[{\hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$ \&}]{bct,  }\item[{const std\+::vector$<$ \hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$$>$ \&}]{partition,  }\item[{\hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$}]{bc\+\_\+node }\end{DoxyParamCaption})}

Prune all those block cluster nodes which are descendants of the block cluster nodes specified in the given {\ttfamily partition}.


\begin{DoxyDescription}
\item[Note ]Because the block cluster nodes in the given {\ttfamily partition} are not contained in the block cluster tree, it is necessary to traverse the whole block cluster tree by recursion, during which each block cluster node is checked whether it belongs to the {\ttfamily partition} so that its descendants should be pruned. 
\end{DoxyDescription}


\begin{DoxyParams}{Parameters}
{\em bct} & The block cluster tree to be pruned. \\
\hline
{\em partition} & The given partition whose descendants will be pruned from the original block cluster tree. \\
\hline
{\em bc\+\_\+node} & The current block cluster node to be checked and determined whether it belongs to the partition so that its descendants should be pruned. \\
\hline
\end{DoxyParams}


References find\+\_\+pointer\+\_\+data(), Block\+Cluster\+Tree$<$ spacedim, Number $>$\+::partition(), and Block\+Cluster\+Tree$<$ spacedim, Number $>$\+::prune\+\_\+descendants\+\_\+from\+\_\+node().

\mbox{\Hypertarget{block__cluster__tree_8h_a16ad2c7c8e746258ce244315d6181c72}\label{block__cluster__tree_8h_a16ad2c7c8e746258ce244315d6181c72}} 
\index{block\+\_\+cluster\+\_\+tree.\+h@{block\+\_\+cluster\+\_\+tree.\+h}!split\+\_\+block\+\_\+cluster\+\_\+node@{split\+\_\+block\+\_\+cluster\+\_\+node}}
\index{split\+\_\+block\+\_\+cluster\+\_\+node@{split\+\_\+block\+\_\+cluster\+\_\+node}!block\+\_\+cluster\+\_\+tree.\+h@{block\+\_\+cluster\+\_\+tree.\+h}}
\subsubsection{\texorpdfstring{split\+\_\+block\+\_\+cluster\+\_\+node()}{split\_block\_cluster\_node()}}
{\footnotesize\ttfamily template$<$int spacedim, typename Number $>$ \\
void split\+\_\+block\+\_\+cluster\+\_\+node (\begin{DoxyParamCaption}\item[{\hyperlink{classTreeNode}{Tree\+Node}$<$ \hyperlink{classBlockCluster}{Block\+Cluster}$<$ spacedim, Number $>$, \hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$\+::child\+\_\+num $>$ $\ast$}]{bc\+\_\+node,  }\item[{\hyperlink{classBlockClusterTree}{Block\+Cluster\+Tree}$<$ spacedim, Number $>$ \&}]{bc\+\_\+tree,  }\item[{const \hyperlink{tree_8h_a922ca07db9633957939f697a65aff11d}{Tree\+Node\+Split\+Mode}}]{split\+\_\+mode,  }\item[{const bool}]{if\+\_\+add\+\_\+child\+\_\+nodes\+\_\+to\+\_\+leaf\+\_\+set = {\ttfamily true} }\end{DoxyParamCaption})}

Split a block cluster node in a block cluster tree according to the given split mode.

After the splitting, the total number of block cluster nodes in the block cluster tree will be updated. Whether the leaf set will be added with the newly created block cluster nodes is controlled by the flag {\ttfamily if\+\_\+add\+\_\+child\+\_\+nodes\+\_\+to\+\_\+leaf\+\_\+set}.


\begin{DoxyDescription}
\item[Note ]If the newly created block cluster nodes are to be added to the leaf set, their parent block cluster node should firstly be erased from the leaf set. This operation is not included in this function and should be performed beforehand. 
\end{DoxyDescription}


\begin{DoxyParams}{Parameters}
{\em bc\+\_\+node} & \\
\hline
{\em bc\+\_\+tree} & \\
\hline
{\em split\+\_\+mode} & \\
\hline
{\em if\+\_\+add\+\_\+child\+\_\+nodes\+\_\+to\+\_\+leaf\+\_\+set} & If the newly created block cluster nodes will be appended to the leaf set of the block cluster tree. \\
\hline
\end{DoxyParams}

\begin{DoxyDescription}
\item[Work flow ]


\begin{DoxyItemize}
\item Horizontal split mode 
\begin{DoxyEnumerate}
\item Set the split mode of the current block cluster node.


\item Create a new block cluster node by constructing its index set as $\tau^* \times \sigma$ with $\tau^* \in S(\tau)$. Its parent node is set to the current block cluster node.


\item Check if the block cluster node is small.


\item Append this new node as a child of the current block cluster node.


\item Add this new node to the leaf set if necessary.


\item Increase the total number of nodes in the block cluster tree.


\end{DoxyEnumerate}


\item Vertical split mode 
\begin{DoxyEnumerate}
\item Set the split mode of the current block cluster node.


\item Create a new block cluster node by constructing its index set as $\tau \times \sigma^*$ with $\sigma^* \in S(\sigma)$. Its parent node is set to the current block cluster node.


\item Check if the block cluster node is small.


\item Append this new node as a child of the current block cluster node.


\item Add this new node to the leaf set if necessary.


\item Increase the total number of nodes in the block cluster tree.


\end{DoxyEnumerate}


\item Cross split mode 
\begin{DoxyEnumerate}
\item Set the split mode of the current block cluster node.


\item Create a new block cluster node by constructing its index set as $\tau^* \times \sigma^*$ with $\tau^* \in S(\tau)$ and $\sigma^* \in S(\sigma)$. Its parent node is set to the current block cluster node.


\item Check if the block cluster node is small.


\item Append this new node as one of the children of the current block cluster node.


\item Add this new node to the leaf set if necessary.


\item Increase the total number of nodes in the block cluster tree.


\end{DoxyEnumerate}


\end{DoxyItemize}
\end{DoxyDescription}

Referenced by H\+Matrix$<$ spacedim, Number $>$\+::h\+\_\+h\+\_\+mmult\+\_\+cross\+\_\+split(), H\+Matrix$<$ spacedim, Number $>$\+::h\+\_\+h\+\_\+mmult\+\_\+horizontal\+\_\+split(), and H\+Matrix$<$ spacedim, Number $>$\+::h\+\_\+h\+\_\+mmult\+\_\+vertical\+\_\+split().

